smart_reduce_kcwi.py